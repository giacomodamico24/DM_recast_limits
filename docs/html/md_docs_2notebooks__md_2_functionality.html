<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DM recast limits: HDMSpectra Functionality</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DM recast limits
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_docs_2notebooks__md_2_functionality.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">HDMSpectra Functionality </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md9"></a></p>
<p>In this notebook we demonstrate the basic functionality of HDMSpectra, highlighting the different options available. Further examples can be found in the notebook "ReproducingPlots", where the plots in 2007.15001 are reproduced.</p>
<p><b>NB:</b> <span class="tt">HDMSpectra</span> must to be installed before running these examples, otherwise the code below will fail at the point of loading <span class="tt">HDMSpectra</span>. Recall, the code can be installed by executing <span class="tt">python setup.py install</span> from the base directory. See the <a href="https://github.com/nickrodd/HDMSpectra">README</a> for additional details.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div>
<div class="line"> </div>
<div class="line">%matplotlib inline</div>
<div class="line">%load_ext autoreload</div>
<div class="line">%autoreload 2</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Load HDMSpectra</span></div>
<div class="line"><span class="keyword">from</span> HDMSpectra <span class="keyword">import</span> HDMSpectra</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Import numpy</span></div>
<div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plotting defaults</span></div>
<div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div>
<div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;text.usetex&#39;</span>] = <span class="keyword">True</span></div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;font.family&#39;</span>] = <span class="stringliteral">&#39;serif&#39;</span> </div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.labelsize&#39;</span>] = 26</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.labelsize&#39;</span>] = 26</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.major.size&#39;</span>] = 5</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.minor.size&#39;</span>] = 2.5</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.major.width&#39;</span>] = 1.0</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.minor.width&#39;</span>] = 0.75</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.major.pad&#39;</span>] = 8</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;xtick.direction&#39;</span>] = <span class="stringliteral">&#39;in&#39;</span></div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.major.size&#39;</span>] = 5</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.minor.size&#39;</span>] = 2.5</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.major.width&#39;</span>] = 1.0</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.minor.width&#39;</span>] = 0.75</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.major.pad&#39;</span>] = 8</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;ytick.direction&#39;</span>] = <span class="stringliteral">&#39;in&#39;</span></div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;legend.fontsize&#39;</span>] = 26</div>
<div class="line">mpl.rcParams[<span class="stringliteral">&#39;legend.frameon&#39;</span>] = <span class="keyword">False</span></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Establish data location</h1>
<p>The spectra themselves are stored within the <span class="tt">HDMSpectra.hdf5</span> file provided with the code. By default this is in the <span class="tt">data</span> directory, although the file can be moved as long as <span class="tt">HDMSpectra</span> is provided the appropriate path.</p>
<div class="fragment"><div class="line">data = <span class="stringliteral">&#39;../data/HDMSpectra.hdf5&#39;</span> <span class="comment"># location of hdf5 file</span></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Example 1: Dark Matter Decay and Annihilation Spectra</h1>
<p>The main workhorse of HDMSpectra is the function <span class="tt">spec</span>. We will explore its basic functionality in this example. To begin with, generating the photon spectrum from $\chi \to b \bar{b}$ for EeV DM is as simple as follows.</p>
<div class="fragment"><div class="line"><span class="comment"># Specify the particles</span></div>
<div class="line">finalstate = 22 <span class="comment"># pdg id of the photon</span></div>
<div class="line">initialstate = 5 <span class="comment"># pdg id of the b-quark</span></div>
<div class="line">mDM = 1.e9 <span class="comment"># dark matter mass in GeV, here 1 EeV</span></div>
<div class="line">x = np.logspace(-4.,0.,1000) <span class="comment"># Energy fraction values, x = 2E/mDM</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Extract the spectrum using HDMSpectra.spec</span></div>
<div class="line">dNdx = HDMSpectra.spec(finalstate, initialstate, x, mDM, data)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot the spectrum</span></div>
<div class="line">fig, ax = plt.subplots(1, figsize=(10/1.1, 8/1.1))</div>
<div class="line"> </div>
<div class="line">plt.plot(x, x**2.*dNdx, </div>
<div class="line">         lw=2.5, c=<span class="stringliteral">&#39;orange&#39;</span>)</div>
<div class="line"> </div>
<div class="line">plt.xscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.yscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.xlim([1.e-4,1.])</div>
<div class="line">plt.ylim([1.e-3,2.e-1])</div>
<div class="line">plt.xlabel(<span class="stringliteral">r&quot;$x = 2E/m_{\chi}$&quot;</span>, fontsize=30)</div>
<div class="line">plt.ylabel(<span class="stringliteral">r&quot;$x^2 dN/dx$&quot;</span>, fontsize=30)</div>
<div class="line"> </div>
<div class="line">plt.tight_layout()</div>
<div class="line">plt.show()</div>
</div><!-- fragment --><p><img src="Functionality_files/Functionality_5_0.png" alt="png" class="inline"/></p>
<p>The above demonstrates the basic functionality of <span class="tt">spec</span>. In detail, the function has the following keywords and defaults.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Argument  </p>
</th><th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Default  </p>
</th><th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Purpose  </p>
</th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">finalstate  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="center"></p>
<p class="endtd">Stable Standard Model final state to determine the spectrum of  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">X  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="center"></p>
<p class="endtd">$X$ in $\chi \to X \bar{X}$  </p>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">xval  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Array of energy fractions at which to determine the spectrum  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">mDM  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Dark Matter mass [GeV]  </p>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">data  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Location of the <span class="tt">hdf5</span> file containing all the spectra  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">annihilation  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">False  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Set to True for $\chi \chi \to X \bar{X}$  </p>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Xbar  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">None  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Manually specify $\bar{X}$, need not be the conjugate of $X$  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">delta  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">False  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Set to True to append the $\delta$-function coefficient  </p>
</td></tr>
</table>
<p>The first five keywords, as used in the above example, are mandatory. In the rest on this notebook we will explore each of these keywords in detail, starting with <span class="tt">annihilation</span> in this section.</p>
<p>Before doing so, let us note an important caveat: <b>Both xval and mDM have an allowed range</b></p><ul>
<li>xval can only be accessed in the range [$10^{-6}$, 1]. The upper bound is imposed by kinematics, whereas the lower bound is enforced as we do not trust the results of our calculation at smaller $x$. Even below $x \sim 10^{-4}$ our results can have significant uncertainty. For more details, see 2007.15001.</li>
<li>mDM can only be accessed in the range [$10^3$, $10^{19}$] GeV (i.e. a TeV to the Planck scale). If <span class="tt">annihilation=True</span>, the lower boundary becomes 500 GeV. We do not go to lower masses as missing power corrections in our calculation become significant. For DM spectra below the TeV scale, we recommend using <a href="http://www.marcocirelli.net/PPPC4DMID.html">PPPC4DMID</a> or <a href="http://home.thep.lu.se/~torbjorn/Pythia.html">Pythia</a>.</li>
</ul>
<p>If values outside these ranges are specified, <span class="tt">spec</span> will return an error.</p>
<p>Let's now explore setting <span class="tt">annihilation=True</span>. This tells the code a desire to compute $\chi \chi \to X \bar{X}$ rather than $\chi \to X \bar{X}$, with energy fractions now specified by $x = E/m_{\chi}$ (rather than $2E/m_{\chi}$ for decay). In practice, the spectrum is identical to that of decay, but with twice the dark matter mass, as we now verify.</p>
<div class="fragment"><div class="line"><span class="comment"># We&#39;ll leave the basic arguments as above</span></div>
<div class="line"> </div>
<div class="line">finalstate = 22 </div>
<div class="line">initialstate = 5 </div>
<div class="line">mDM = 1.e9</div>
<div class="line">x = np.logspace(-4.,0.,1000)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Extract both spectra</span></div>
<div class="line">dNdx_dec = HDMSpectra.spec(finalstate, initialstate, x, mDM, data)</div>
<div class="line">dNdx_ann = HDMSpectra.spec(finalstate, initialstate, x, mDM/2., data, annihilation=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot the spectrum</span></div>
<div class="line">fig, ax = plt.subplots(1, figsize=(10/1.1, 8/1.1))</div>
<div class="line"> </div>
<div class="line">plt.plot(x, x**2.*dNdx_dec, </div>
<div class="line">         lw=2.5, c=<span class="stringliteral">&#39;orange&#39;</span>, label=<span class="stringliteral">r&#39;Decay $m_{\chi} = 10^9$ GeV&#39;</span>)</div>
<div class="line"> </div>
<div class="line">plt.plot(x, x**2.*dNdx_ann, </div>
<div class="line">         lw=2.5, c=<span class="stringliteral">&#39;black&#39;</span>,ls=<span class="stringliteral">&#39;:&#39;</span>, label=<span class="stringliteral">r&#39;Annihilation $m_{\chi} = 5 \times 10^8$ GeV&#39;</span>)</div>
<div class="line"> </div>
<div class="line">plt.xscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.yscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.xlim([1.e-4,1.])</div>
<div class="line">plt.ylim([1.e-3,2.e-1])</div>
<div class="line">plt.xlabel(<span class="stringliteral">r&quot;$x = 2E/m_{\chi}$&quot;</span>, fontsize=30)</div>
<div class="line">plt.ylabel(<span class="stringliteral">r&quot;$x^2 dN/dx$&quot;</span>, fontsize=30)</div>
<div class="line">plt.legend()</div>
<div class="line">plt.tight_layout()</div>
<div class="line">plt.show()</div>
</div><!-- fragment --><p><img src="Functionality_files/Functionality_7_0.png" alt="png" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Example 2: Exploring Particle ID Inputs</h1>
<p>Next we will explore the functionality of each of the keywords <span class="tt">finalstate</span> and <span class="tt">X</span> in turn.</p>
<p>Firstly, <span class="tt">finalstate</span> specifies which standard model stable particle to determine the spectrum of. The full list of available options are: </p><div class="fragment"><div class="line">11, -11,                   # electron</div>
<div class="line">12, -12, 14, -14, 16, -16, # neutrino</div>
<div class="line">22,                        # photon</div>
<div class="line">2212, -2212                # proton</div>
</div><!-- fragment --><p> These particles are specified by the relevant <a href="http://pdg.lbl.gov/2007/reviews/montecarlorpp.pdf">pdg id</a> code. Alternatively, <span class="tt">finalstate</span> can be equally well specified by the following strings (where <span class="tt">a</span> denoted anti-particle): </p><div class="fragment"><div class="line">&#39;e&#39;, &#39;ae&#39;,                                         # electron</div>
<div class="line">&#39;nue&#39;, &#39;anue&#39;, &#39;numu&#39;, &#39;anumu&#39;, &#39;nutau&#39;, &#39;anutau&#39;, # neutrino</div>
<div class="line">&#39;gamma&#39;,                                           # photon</div>
<div class="line">&#39;p&#39;, &#39;ap&#39;                                          # proton</div>
</div><!-- fragment --><p>The output for specifying the string of pdg id is identical.</p>
<div class="fragment"><div class="line">initialstate = 5</div>
<div class="line">mDM = 1.e9</div>
<div class="line">x = 0.5</div>
<div class="line"> </div>
<div class="line">print(HDMSpectra.spec(22, initialstate, x, mDM, data))</div>
<div class="line">print(HDMSpectra.spec(<span class="stringliteral">&#39;gamma&#39;</span>, initialstate, x, mDM, data))</div>
</div><!-- fragment --> <pre class="fragment">[0.02341701]
[0.02341701]
</pre><p>A similar set of options is provided to specify the initial state, $X$. In detail, the following list of pdg ids </p><div class="fragment"><div class="line">1, 2, 3, 4, 5, 6,       # Q</div>
<div class="line">11, 12, 13, 14, 15, 16, # L</div>
<div class="line">21, 22, 23, 24,         # V</div>
<div class="line">25                      # H</div>
</div><!-- fragment --><p> and string </p><div class="fragment"><div class="line">&#39;d&#39;, &#39;u&#39;, &#39;s&#39;, &#39;c&#39;, &#39;b&#39;, &#39;t&#39;,             # Q</div>
<div class="line">&#39;e&#39;, &#39;nue&#39;, &#39;mu&#39;, &#39;numu&#39;, &#39;tau&#39;, &#39;nutau&#39;, # L</div>
<div class="line">&#39;g&#39;, &#39;gamma&#39;, &#39;Z&#39;, &#39;W&#39;,                   # V</div>
<div class="line">&#39;h&#39;                                       # H</div>
</div><!-- fragment --><p> is available.</p>
<p>By default it is assumed that the process is $\chi \to X \bar{X}$ (or if $X$ has no conjugate, as for the Higgs, then just $X X$). We will explore how to specify more general final states below, but for now note that if we set $X$ to be a particle of antiparticle we will get an identical result.</p>
<div class="fragment"><div class="line">finalstate = 22</div>
<div class="line">mDM = 1.e9</div>
<div class="line">x = 0.5</div>
<div class="line"> </div>
<div class="line">print(HDMSpectra.spec(finalstate,  5, x, mDM, data))</div>
<div class="line">print(HDMSpectra.spec(finalstate, -5, x, mDM, data))</div>
</div><!-- fragment --> <pre class="fragment">[0.02341701]
[0.02341701]
</pre><p>Note this option is only available for the pdg, adding <span class="tt">a</span> to the front of the strings allowed for $X$ will return an error.</p>
<p>As our calculation starts in the full unbroken standard model, at the high scale it is also possible to specify the polarization or helicity of $X$. For the pdg ids this amounts to adding a prefix 19 for left handed/negative helicity, 29 for right handed/positive helicity, or 39 for a longitudinal polarization. This must be added so the pdg id is now a 4-digit number, e.g. a left-handed strange-quark is specified as <span class="tt">1903</span>. The full list of available options is now </p><div class="fragment"><div class="line">1901, 1902, 1903, 1904, 1905, 1906, # Q_L</div>
<div class="line">1911, 1912, 1913, 1914, 1915, 1916, # L_L</div>
<div class="line">2901, 2902, 2903, 2904, 2905, 2906, # Q_R</div>
<div class="line">2911, 2913, 2915,                   # L_R</div>
<div class="line">1921, 1922, 1923, 1924,             # V_L</div>
<div class="line">2921, 2922, 2923, 2924,             # V_R</div>
<div class="line">3923, 3924,                         # V_0</div>
<div class="line">25                                  # H</div>
</div><!-- fragment --><p>It is also possible to specify these at the level of string, by appending <span class="tt">L</span>, <span class="tt">R</span>, or <span class="tt">0</span>, e.g. a longitudinal $Z$ is specified by <span class="tt">Z0</span>.</p>
<p>By default, if no helicity/polarization is specified the spectrum returns the average of the available states. This is verified in the example below.</p>
<div class="fragment"><div class="line">print(HDMSpectra.spec(22, 1905, x, mDM, data))</div>
<div class="line">print(HDMSpectra.spec(22, 2905, x, mDM, data))</div>
<div class="line">print((HDMSpectra.spec(22, 1905, x, mDM, data) + HDMSpectra.spec(22, 2905, x, mDM, data))/2.)</div>
<div class="line">print(HDMSpectra.spec(22, 5, x, mDM, data))</div>
</div><!-- fragment --> <pre class="fragment">[0.0262683]
[0.02056572]
[0.02341701]
[0.02341701]
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Example 3: Extracting a $\delta$-function coefficient</h1>
<p>For certain states, such as $\chi \to \nu_e \bar{\nu}_e \to \nu_e$, there can be a significant $\delta$-function coefficient located at $x=1$, associated with the probability that there were no corrections to the initial hard process. In order to access this, <span class="tt">delta = True</span> should be set, in which case the delta function coefficient will be appended as the last element to the spectrum (if one exists, otherwise the code will append 0). For example,</p>
<div class="fragment"><div class="line">mDM = 1.e9</div>
<div class="line">x = 0.5</div>
<div class="line"> </div>
<div class="line">print(HDMSpectra.spec(22, 22, x, mDM, data))</div>
<div class="line">print(HDMSpectra.spec(22, 22, x, mDM, data, delta=<span class="keyword">True</span>))</div>
</div><!-- fragment --> <pre class="fragment">[0.06304888]
[0.06304888 0.92546995]
</pre><p>The full list of states that have a non-zero $\delta$-function contribution that we compute are as follows:</p><ul>
<li>$e_L \to e$, $\bar{e}_L \to \bar{e}$</li>
<li>$e_R \to e$, $\bar{e}_R \to \bar{e}$</li>
<li>$\nu_e \to \nu_e$, $\bar{\nu}_e \to \bar{\nu}_e$</li>
<li>$\nu_{\mu} \to \nu_{\mu}$, $\bar{\nu}_{\mu} \to \bar{\nu}_{\mu}$</li>
<li>$\nu_{\tau} \to \nu_{\tau}$, $\bar{\nu}_{\tau} \to \bar{\nu}_{\tau}$</li>
<li>$\gamma_L \to \gamma$, $\gamma_R \to \gamma$</li>
<li>$Z_L \to \gamma$, $Z_R \to \gamma$</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Example 4: Spectra for $\chi \to X Y$, where $Y \neq \bar{X}$</h1>
<p>As mentioned above, by default the spectrum is produced for $\chi \to X \bar{X}$. For certain models, a more general initial state may be desired. In that case $\bar{X}$ can be set manually, and need not be related to $X$. Note the same principles as above apply, if an unpolarized initial state is specified, the average of the polarizations is produced.</p>
<p>An example is provided below.</p>
<div class="fragment"><div class="line">finalstate = 22</div>
<div class="line">mDM = 1.e9</div>
<div class="line">x = 0.5</div>
<div class="line"> </div>
<div class="line">print(HDMSpectra.spec(finalstate,  5, x, mDM, data))</div>
<div class="line">print(HDMSpectra.spec(finalstate,  5, x, mDM, data, Xbar=-5))</div>
<div class="line">print(HDMSpectra.spec(finalstate,  5, x, mDM, data, Xbar=11))</div>
</div><!-- fragment --> <pre class="fragment">[0.02341701]
[0.02341701]
[0.1214471]
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Example 5: Obtaining explicit Fragmentation Functions</h1>
<p>The explicit fragmentation functions used to compute the spectra themselves can also be accessed, but using a different function <span class="tt">HDMSpectra.FF</span>. If one was trying to study the evolution of a single emitted particle, these can be used. Also if the initial process of the decay/annihilation is more complicated than 2-body, the spectrum can be convolved with the relevant fragmentation functions as described in our paper. In detail, <span class="tt">FF</span> returns</p>
<p>$$D_i^j(x;\,Q, 0)$$</p>
<p>i.e. the evolution of a particle $i$ at a scale $\mu \sim Q$ into a state $j$ at $\mu \sim 0$, evolved at an energy fraction $x$. This is <b>not</b> the momentum weighted fragmentation function $d(x) = x\, D(x)$.</p>
<p>The keyword arguments of this function are</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Argument  </p>
</th><th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Default  </p>
</th><th class="markdownTableHeadNone"><p class="starttd" align="right"></p>
<p class="endtd">Purpose  </p>
</th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">finalstate  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="center"></p>
<p class="endtd">Final state or $j$  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">initialstate  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="center"></p>
<p class="endtd">Initial state or $i$  </p>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">xval  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Array of energy fractions at which to determine $D(x)$  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Q  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Scale of $Q$ [GeV]  </p>
</td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">data  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">-  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Location of the <span class="tt">hdf5</span> file containing all the spectra  </p>
</td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">delta  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">False  </p>
</td><td class="markdownTableBodyNone"><p class="starttd" align="right"></p>
<p class="endtd">Set to True to append the $\delta$-function coefficient  </p>
</td></tr>
</table>
<p>The functionality for the keywords mirrors that of <span class="tt">spec</span>.</p>
<p>As an example, we can reconstruct the spectrum from two fragmentation functions as follows.</p>
<div class="fragment"><div class="line">finalstate = 22 </div>
<div class="line">mDM = 1.e9</div>
<div class="line">x = np.logspace(-4.,0.,1000)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Extract the spectra</span></div>
<div class="line">dNdx = HDMSpectra.spec(finalstate, 5, x, mDM, data)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Extract the FF, note these are sampled at Q = mDM/2 for decay</span></div>
<div class="line">FF1 = HDMSpectra.FF(finalstate, 5, x, mDM/2., data)</div>
<div class="line">FF2 = HDMSpectra.FF(finalstate, -5, x, mDM/2., data)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot the spectrum</span></div>
<div class="line">fig, ax = plt.subplots(1, figsize=(10/1.1, 8/1.1))</div>
<div class="line"> </div>
<div class="line">plt.plot(x, x**2.*dNdx, </div>
<div class="line">         lw=2.5, c=<span class="stringliteral">&#39;orange&#39;</span>, label=<span class="stringliteral">r&#39;spec&#39;</span>)</div>
<div class="line"> </div>
<div class="line">plt.plot(x, x**2.*(FF1+FF2), </div>
<div class="line">         lw=2.5, c=<span class="stringliteral">&#39;black&#39;</span>,ls=<span class="stringliteral">&#39;:&#39;</span>, label=<span class="stringliteral">r&#39;FF&#39;</span>)</div>
<div class="line"> </div>
<div class="line">plt.xscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.yscale(<span class="stringliteral">&#39;log&#39;</span>)</div>
<div class="line">plt.xlim([1.e-4,1.])</div>
<div class="line">plt.ylim([1.e-3,2.e-1])</div>
<div class="line">plt.xlabel(<span class="stringliteral">r&quot;$x = 2E/m_{\chi}$&quot;</span>, fontsize=30)</div>
<div class="line">plt.ylabel(<span class="stringliteral">r&quot;$x^2 dN/dx$&quot;</span>, fontsize=30)</div>
<div class="line">plt.legend()</div>
<div class="line">plt.tight_layout()</div>
<div class="line">plt.show()</div>
</div><!-- fragment --><p><img src="Functionality_files/Functionality_20_0.png" alt="png" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
